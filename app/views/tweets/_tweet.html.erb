<div class="card w-100">
  <div class="d-flex">

    <img src="<%= resource.user.profile_pic_url %>" style="width: 50px; height: 50px;" class="rounded-circle ml-3 mt-3" alt="profile pic">
        
    <div class="card-body p-3">
      
      <div class="d-flex align-items-center justify-content-between">
              
        <div class="d-flex">
          <h5 class="card-title font-weight-bold"><%= resource.user %></h5>
          <span><%= link_to "#{time_ago_in_words(resource.created_at)} ago", resource, class: "text-muted ml-2" %></span>
        </div>
              
        <% if user_signed_in? %>

          <% if resource.get_user_id == current_user.id %>
            
            <div>
              <button class="btn btn-light dropdown-toggle" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"></button>
                <div class="dropdown-menu">
                  <%= link_to fa_icon("pencil") + " Edit tweet", edit_tweet_path(resource), class: "dropdown-item" %>
                  <%= link_to fa_icon("trash-o") + " Delete tweet", tweet_path(resource),
                      class: "dropdown-item",
                      data: { confirm: "Are you sure?" },
                      method: :delete %>
                </div>
            </div>

          <% else %>

            <% unless current_user.follows?(resource.user) %>

              <%= form_with(model: @friend, url: friends_path(current_user.id)) do |f| %>
                <%= f.hidden_field :friend_id, value: resource.get_user_id %>
                <%= f.submit "Follow", class: "btn btn-outline-info rounded-pill" %>
              <% end %>
              
            <% else %>
            
              <%= link_to "Unfollow",
                  friend_path(current_user.id,
                  current_user.get_follow_id(resource.user)),
                  class: "btn btn-outline-info rounded-pill", method: "delete" %>
            <% end %>
          <% end %>
        <% end %>
      </div>

      <p class="card-text mb-1">
        <% resource.split_content.each do |word| %>
          <% if resource.get_hashtags.include?(word) %>
            <%= link_to word, tweets_path(search: word) %>
          <% else %>
            <%= "#{word} " %>
          <% end %>
        <% end %>
      </p>

      <% unless resource.retweet_from_id.nil? %>
        <%= render 'tweet', resource: resource.retweet_from %>
      <% end %>

      <div class="d-flex justify-content-around">

        <div>
          <%= link_to fa_icon("retweet"),
              new_tweet_path({ reference: resource }),
              class: "#{resource.retweeted_by?(current_user) ? "text-success" : "text-muted"}" %>
          <span class="text-muted ml-3"><%= resource.tweets_count %></span>
        </div>

        <div>
          <% if user_signed_in? && resource.liked_by?(current_user) %>
            <%= link_to fa_icon("heart"), tweet_like_path(resource, resource.get_like_id(current_user)), method: "delete", class: "text-danger" %>
          <% else %>
            <%= link_to fa_icon("heart-o"), tweet_likes_path(resource), method: "post", class: "text-muted" %>
          <% end %>
          <span class="text-muted ml-3"><%= resource.likes_count %></span>
        </div>

      </div>

    </div>
  </div>
</div>
